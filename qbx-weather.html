<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Is It Sunny or Raining?</title>
<style>
  body { font-family: sans-serif; background:#f8f8f8; color:#222; text-align:center; }
  h1 { margin-top:20px; }
  .cities { display:flex; flex-wrap:wrap; justify-content:center; margin:20px; gap:10px; }
  .city { padding:10px 18px; background:#eee; border-radius:8px; cursor:pointer; }
  .city:hover { background:#ddd; }
  #result { margin-top:20px; font-size:1.3em; font-weight:bold; }
  #debug { margin-top:15px; font-size:0.8em; color:#666; white-space:pre; text-align:left; max-width:500px; margin-left:auto; margin-right:auto; }
</style>
</head>
<body>

<h1>üåç Guess the Weather!</h1>
<p>Click a city and I‚Äôll fetch the *real* weather.</p>

<div class="cities" id="cities"></div>
<div id="result">Idle. Click a city.</div>
<div id="debug"></div>

<script>
const API_KEY = "553b39e4a880493f8fe80855252108"; // WeatherAPI key
const CITIES = ["Rome","London","Madrid","Paris","Berlin","Tokyo","New York","Moscow","Sydney","Cairo","Mexico City","Toronto","Buenos Aires","Cape Town","Beijing","Delhi","Bangkok","Istanbul","Athens","Lisbon"];

function mapWeather(code){
  code = parseInt(code,10);
  if(code === 1000) return "Sunny ‚òÄÔ∏è";                // clear
  if([1003,1006,1009].includes(code)) return "Cloudy ‚òÅÔ∏è"; // cloudy variants
  if([1030,1135,1147].includes(code)) return "Foggy üå´Ô∏è";  // fog/mist
  if(code===1087 || (code>=1273 && code<=1282)) return "Stormy ‚õàÔ∏è"; // thunder
  if((code>=1066 && code<=1237) || (code>=1249 && code<=1264)) return "Snowy ‚ùÑÔ∏è"; // snow/sleet
  if((code>=1063 && code<=1201) || (code>=1240 && code<=1246)) return "Rainy üåßÔ∏è"; // rain
  return "Cloudy ‚òÅÔ∏è"; // fallback
}

async function fetchWeather(city){
  const url = `https://api.weatherapi.com/v1/current.json?key=${API_KEY}&q=${encodeURIComponent(city)}&aqi=no&_=${Date.now()}`;
  const res = await fetch(url);
  if(!res.ok) throw new Error("API error " + res.status);
  return await res.json();
}

function makeCityButtons(){
  const box = document.getElementById("cities");
  CITIES.forEach(city=>{
    const btn=document.createElement("div");
    btn.className="city";
    btn.textContent=city;
    btn.onclick=async()=>{
      document.getElementById("result").textContent=`Fetching ${city}...`;
      try{
        const data=await fetchWeather(city);
        const cond=data.current.condition;
        const mapped=mapWeather(cond.code);
        document.getElementById("result").textContent=`${city}: ${mapped}`;
        document.getElementById("debug").textContent=
          `Raw: ${cond.text} (code ${cond.code})\nTemp: ${data.current.temp_c}¬∞C`;
      }catch(e){
        document.getElementById("result").textContent="Error fetching weather.";
        console.error(e);
      }
    };
    box.appendChild(btn);
  });
}

makeCityButtons();
</script>
<p style="margin-top:30px;font-size:0.8em;color:#666">
Powered by <a href="https://www.weatherapi.com/" title="Weather API">WeatherAPI.com</a>
</p>
</body>
</html>
